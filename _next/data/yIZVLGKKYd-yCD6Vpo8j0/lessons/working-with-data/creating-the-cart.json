{"pageProps":{"post":{"attributes":{},"html":"<p>Let&#39;s work with the Cart now.</p>\n<p>Now that we have a Cart Manager and we can inject it, we can make our &quot;add to cart&quot; button work within details page.</p>\n<h2 id=\"detailspage\">DetailsPage</h2>\n<pre><code class=\"hljs language-swift\"><span class=\"hljs-comment\">//</span>\n<span class=\"hljs-comment\">//  DetailsPage.swift</span>\n<span class=\"hljs-comment\">//  CoffeeMastersTest1</span>\n<span class=\"hljs-comment\">//</span>\n<span class=\"hljs-comment\">//  Created by Maximiliano Firtman on 4/14/22.</span>\n<span class=\"hljs-comment\">//</span>\n\n<span class=\"hljs-keyword\">import</span> SwiftUI\n\n<span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">DetailsPage</span>: <span class=\"hljs-title class_\">View</span> {\n    \n    <span class=\"hljs-keyword\">var</span> product: <span class=\"hljs-type\">Product</span>\n    <span class=\"hljs-meta\">@State</span> <span class=\"hljs-keyword\">var</span> quantity: <span class=\"hljs-type\">Int</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">1</span>\n    <span class=\"hljs-meta\">@EnvironmentObject</span> <span class=\"hljs-keyword\">var</span> cartManager: <span class=\"hljs-type\">CartManager</span>\n    <span class=\"hljs-meta\">@Environment</span>(\\.dismiss) <span class=\"hljs-keyword\">var</span> dismiss\n        \n    <span class=\"hljs-keyword\">var</span> body: <span class=\"hljs-keyword\">some</span> <span class=\"hljs-type\">View</span> {\n        <span class=\"hljs-type\">ScrollView</span> {\n            <span class=\"hljs-type\">ProductThumbnail</span>(url: product.imageURL)\n                .padding(.top, <span class=\"hljs-number\">32</span>)\n            <span class=\"hljs-type\">Text</span>(product.description <span class=\"hljs-operator\">??</span> <span class=\"hljs-string\">&quot;&quot;</span>)\n                .frame(maxWidth: .infinity)\n                .multilineTextAlignment(.leading)\n                .padding(<span class=\"hljs-number\">24</span>)\n            <span class=\"hljs-type\">HStack</span> {\n                <span class=\"hljs-type\">Text</span>(<span class=\"hljs-string\">&quot;$ <span class=\"hljs-subst\">\\(product.price, specifier: <span class=\"hljs-string\">&quot;%.2f&quot;</span>)</span> ea&quot;</span>)\n                <span class=\"hljs-type\">Stepper</span>(value: <span class=\"hljs-variable\">$quantity</span>, in: <span class=\"hljs-number\">1</span><span class=\"hljs-operator\">...</span><span class=\"hljs-number\">10</span>) { }\n            }\n                .frame(maxWidth: .infinity)\n                .padding(<span class=\"hljs-number\">30</span>)\n            \n            <span class=\"hljs-keyword\">let</span> total <span class=\"hljs-operator\">=</span> product.price <span class=\"hljs-operator\">*</span> <span class=\"hljs-type\">Double</span>(<span class=\"hljs-variable\">$quantity</span>.wrappedValue)\n                        \n            <span class=\"hljs-type\">Text</span>(<span class=\"hljs-string\">&quot;Subtotal $<span class=\"hljs-subst\">\\(total, specifier: <span class=\"hljs-string\">&quot;%.2f&quot;</span>)</span>&quot;</span>)\n                .bold()\n                .padding(<span class=\"hljs-number\">12</span>)\n            \n            <span class=\"hljs-type\">Button</span>(<span class=\"hljs-string\">&quot;Add <span class=\"hljs-subst\">\\(quantity)</span> to Cart&quot;</span>) {\n                dismiss()\n                cartManager.add(product: product, quantity: quantity)\n            }\n                .padding()\n                .frame(width: <span class=\"hljs-number\">250.0</span>)\n                .background(<span class=\"hljs-type\">Color</span>(<span class=\"hljs-string\">&quot;Alternative2&quot;</span>))\n                .foregroundColor(<span class=\"hljs-type\">Color</span>.black)\n                .cornerRadius(<span class=\"hljs-number\">25</span>)\n\n        }\n            .navigationTitle(product.name)\n    }\n}\n\n<span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">DetailsPage_Previews</span>: <span class=\"hljs-title class_\">PreviewProvider</span> {\n    <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">var</span> previews: <span class=\"hljs-keyword\">some</span> <span class=\"hljs-type\">View</span> {\n        <span class=\"hljs-type\">NavigationView</span> {\n            <span class=\"hljs-type\">DetailsPage</span>(product: <span class=\"hljs-type\">Product</span>(id: <span class=\"hljs-number\">0</span>, name: <span class=\"hljs-string\">&quot;Demo Product&quot;</span>, description: <span class=\"hljs-string\">&quot;Demo description&quot;</span>, price: <span class=\"hljs-number\">23</span>, image: <span class=\"hljs-string\">&quot;blacktea.png&quot;</span>))\n                .environmentObject(<span class=\"hljs-type\">LikesManager</span>())\n            .previewDevice(<span class=\"hljs-string\">&quot;iPhone 11 Pro&quot;</span>)\n        }\n    }\n}\n\n<span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">ProductThumbnail</span>: <span class=\"hljs-title class_\">View</span> {\n    <span class=\"hljs-keyword\">var</span> url: <span class=\"hljs-type\">URL</span>\n    \n    <span class=\"hljs-keyword\">var</span> body: <span class=\"hljs-keyword\">some</span> <span class=\"hljs-type\">View</span> {\n        <span class=\"hljs-type\">AsyncImage</span>(url: url)\n            .cornerRadius(<span class=\"hljs-number\">5</span>)\n            .frame(maxWidth: .infinity, idealHeight: <span class=\"hljs-number\">150</span>, maxHeight: <span class=\"hljs-number\">150</span>)\n\n    }\n}\n</code></pre>\n<h2 id=\"orderpage\">OrderPage</h2>\n<pre><code class=\"hljs language-swift\"><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">OrderPage</span>: <span class=\"hljs-title class_\">View</span> {\n    \n    <span class=\"hljs-meta\">@EnvironmentObject</span> <span class=\"hljs-keyword\">var</span> menuManager: <span class=\"hljs-type\">MenuManager</span>\n    <span class=\"hljs-meta\">@EnvironmentObject</span> <span class=\"hljs-keyword\">var</span> cartManager: <span class=\"hljs-type\">CartManager</span>\n    \n    <span class=\"hljs-meta\">@AppStorage</span>(<span class=\"hljs-string\">&quot;name&quot;</span>) <span class=\"hljs-keyword\">var</span> name <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;&quot;</span>\n    <span class=\"hljs-meta\">@AppStorage</span>(<span class=\"hljs-string\">&quot;phone&quot;</span>) <span class=\"hljs-keyword\">var</span> phone <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;&quot;</span>\n    \n    <span class=\"hljs-meta\">@State</span> <span class=\"hljs-keyword\">var</span> orderConfirmed <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">false</span>\n\n    <span class=\"hljs-keyword\">var</span> body: <span class=\"hljs-keyword\">some</span> <span class=\"hljs-type\">View</span> {\n        \n        <span class=\"hljs-type\">NavigationView</span> {\n            <span class=\"hljs-keyword\">if</span> cartManager.products.count <span class=\"hljs-operator\">==</span> <span class=\"hljs-number\">0</span> {\n                <span class=\"hljs-type\">Text</span>(<span class=\"hljs-string\">&quot;Your order is empty&quot;</span>)\n                    .navigationTitle(<span class=\"hljs-string\">&quot;Your Order&quot;</span>)\n            } <span class=\"hljs-keyword\">else</span> {\n                <span class=\"hljs-type\">List</span> {\n                    <span class=\"hljs-type\">Section</span>(<span class=\"hljs-string\">&quot;ITEMS&quot;</span>) {\n                        <span class=\"hljs-type\">ForEach</span>(cartManager.products, id:\\.<span class=\"hljs-number\">0</span>.id) { item <span class=\"hljs-keyword\">in</span>\n                            <span class=\"hljs-type\">OrderItem</span>(item: item)\n                        }\n                    }.listRowBackground(<span class=\"hljs-type\">Color</span>(<span class=\"hljs-string\">&quot;Background&quot;</span>))\n                                        \n                    <span class=\"hljs-type\">Section</span>(<span class=\"hljs-string\">&quot;YOUR DETAILS&quot;</span>) {\n                        <span class=\"hljs-type\">VStack</span> {\n                            <span class=\"hljs-type\">TextField</span>(<span class=\"hljs-string\">&quot;Your Name&quot;</span>, text: <span class=\"hljs-variable\">$name</span>)\n                                .textFieldStyle(.roundedBorder)\n                            <span class=\"hljs-type\">Spacer</span>().frame(height: <span class=\"hljs-number\">20</span>)\n                            <span class=\"hljs-type\">TextField</span>(<span class=\"hljs-string\">&quot;Your Phone #&quot;</span>, text: <span class=\"hljs-variable\">$phone</span>)\n                                .keyboardType(.phonePad)\n                                .textFieldStyle(.roundedBorder)\n                        }.padding(.top)\n                         .padding(.bottom)\n                    }.listRowBackground(<span class=\"hljs-type\">Color</span>(<span class=\"hljs-string\">&quot;Background&quot;</span>))\n                    \n                    <span class=\"hljs-type\">Section</span>() {\n                        <span class=\"hljs-type\">HStack</span> {\n                            <span class=\"hljs-type\">Spacer</span>()\n                            <span class=\"hljs-type\">Text</span>(<span class=\"hljs-string\">&quot;Total&quot;</span>)\n                            <span class=\"hljs-type\">Spacer</span>()\n                            <span class=\"hljs-type\">Text</span>(<span class=\"hljs-string\">&quot;$ <span class=\"hljs-subst\">\\(cartManager.total(), specifier: <span class=\"hljs-string\">&quot;%.2f&quot;</span>)</span>&quot;</span>)\n                                .bold()\n                            <span class=\"hljs-type\">Spacer</span>()\n                        }\n                    }.listRowBackground(<span class=\"hljs-type\">Color</span>.clear)\n                    \n                    <span class=\"hljs-type\">Section</span> {\n                        <span class=\"hljs-type\">HStack</span> {\n                            <span class=\"hljs-type\">Spacer</span>()\n                            <span class=\"hljs-type\">Button</span>(<span class=\"hljs-string\">&quot;Place Order&quot;</span>) {\n                                <span class=\"hljs-comment\">//<span class=\"hljs-doctag\">TODO:</span> Validation</span>\n                                orderConfirmed <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">true</span>\n                            }\n                                .padding()\n                                .frame(width: <span class=\"hljs-number\">250.0</span>)\n                                .background(<span class=\"hljs-type\">Color</span>(<span class=\"hljs-string\">&quot;Alternative2&quot;</span>))\n                                .foregroundColor(<span class=\"hljs-type\">Color</span>.black)\n                                .cornerRadius(<span class=\"hljs-number\">25</span>)\n                                \n                            <span class=\"hljs-type\">Spacer</span>()\n                        }\n                    }.listRowBackground(<span class=\"hljs-type\">Color</span>.clear)\n                }\n                .listSectionSeparatorTint(<span class=\"hljs-type\">Color</span>(<span class=\"hljs-string\">&quot;AccentColor&quot;</span>))\n                .listStyle(.insetGrouped)\n                .navigationTitle(<span class=\"hljs-string\">&quot;Your Order&quot;</span>)\n                .alert(<span class=\"hljs-string\">&quot;Order&quot;</span>, isPresented: <span class=\"hljs-variable\">$orderConfirmed</span>, actions: {\n                    <span class=\"hljs-type\">Button</span>(<span class=\"hljs-string\">&quot;OK&quot;</span>, role: .cancel) {\n                        <span class=\"hljs-comment\">//<span class=\"hljs-doctag\">TODO:</span> send order</span>\n                        orderConfirmed <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">false</span>\n                        cartManager.clear()\n                    }\n                }, message: {\n                    <span class=\"hljs-type\">Text</span>(<span class=\"hljs-string\">&quot;Your order is being prepared.&quot;</span>)\n                        .font(.title)\n                })\n            }\n        }\n    }\n}\n</code></pre>\n","slug":"creating-the-cart","title":"Creating the Cart","section":"Working with Data","icon":"database","filePath":"/home/runner/work/intro-swift/intro-swift/lessons/05-working-with-data/D-creating-the-cart.md","nextSlug":"/intro-swift/lessons/using-APIs-and-JSON/adding-alamofire-dependency","prevSlug":"/intro-swift/lessons/working-with-data/using-environment-objects"}},"__N_SSG":true}