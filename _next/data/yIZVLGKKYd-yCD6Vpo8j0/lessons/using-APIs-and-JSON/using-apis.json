{"pageProps":{"post":{"attributes":{},"html":"<p>We will now use Alamofire to download a JSON from an API. We will be doing it within ProductManager</p>\n<pre><code class=\"hljs language-swift\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MenuManager</span>: <span class=\"hljs-title class_\">ObservableObject</span> {\n    \n    <span class=\"hljs-meta\">@Published</span> <span class=\"hljs-keyword\">var</span> menu: [<span class=\"hljs-type\">Category</span>] <span class=\"hljs-operator\">=</span> []\n    \n    <span class=\"hljs-keyword\">init</span>() {\n        refreshItemsFromNetwork()\n    }\n    \n    <span class=\"hljs-keyword\">func</span> <span class=\"hljs-title function_\">refreshItemsFromNetwork</span>()  {\n        <span class=\"hljs-type\">AF</span>.request(<span class=\"hljs-string\">&quot;https://firtman.github.io/coffeemasters/api/menu.json&quot;</span>)\n            .responseDecodable(of: [<span class=\"hljs-type\">Category</span>].<span class=\"hljs-keyword\">self</span>) { response <span class=\"hljs-keyword\">in</span>\n                <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">let</span> menuFromNetwork <span class=\"hljs-operator\">=</span> response.value {\n                    <span class=\"hljs-keyword\">self</span>.menu <span class=\"hljs-operator\">=</span> menuFromNetwork\n                }\n            }\n    }\n}\n</code></pre>\n<h2 id=\"decodable-types\">Decodable Types</h2>\n<p>To parse automatically the JSON into our structures, they must conform to <code>Decodable</code></p>\n<pre><code class=\"hljs language-swift\"><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">Product</span>: <span class=\"hljs-title class_\">Identifiable</span>, <span class=\"hljs-title class_\">Decodable</span> {\n    <span class=\"hljs-keyword\">var</span> id: <span class=\"hljs-type\">Int</span>\n    <span class=\"hljs-keyword\">var</span> name: <span class=\"hljs-type\">String</span>\n    <span class=\"hljs-keyword\">var</span> description: <span class=\"hljs-type\">String</span>?\n    <span class=\"hljs-keyword\">var</span> price: <span class=\"hljs-type\">Double</span>\n    <span class=\"hljs-keyword\">var</span> image: <span class=\"hljs-type\">String</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;&quot;</span>\n    \n    <span class=\"hljs-keyword\">var</span> imageURL: <span class=\"hljs-type\">URL</span> {\n        <span class=\"hljs-type\">URL</span>(string: <span class=\"hljs-string\">&quot;https://firtman.github.io/coffeemasters/api/images/<span class=\"hljs-subst\">\\(<span class=\"hljs-keyword\">self</span>.image)</span>&quot;</span>)<span class=\"hljs-operator\">!</span>\n    }\n}\n\n<span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">Category</span>: <span class=\"hljs-title class_\">Identifiable</span>, <span class=\"hljs-title class_\">Decodable</span> {\n    <span class=\"hljs-keyword\">var</span> id: <span class=\"hljs-type\">String</span> { name }\n    <span class=\"hljs-keyword\">var</span> name: <span class=\"hljs-type\">String</span>\n    <span class=\"hljs-keyword\">var</span> products: [<span class=\"hljs-type\">Product</span>] <span class=\"hljs-operator\">=</span> []\n}\n</code></pre>\n<h2 id=\"menupage\">MenuPage</h2>\n<p>We can now make our List refreshable by adding to the List a modifier</p>\n<pre><code class=\"hljs language-swift\">.refreshable {\n    menuManager.refreshItemsFromNetwork()\n}\n</code></pre>\n","slug":"using-apis","title":"Using Apis","section":"Using APIs and JSON","icon":"bridge","filePath":"/home/runner/work/intro-swift/intro-swift/lessons/06-using-APIs-and-JSON/B-using-apis.md","nextSlug":"/intro-swift/lessons/using-APIs-and-JSON/bonus-likes","prevSlug":"/intro-swift/lessons/using-APIs-and-JSON/adding-alamofire-dependency"}},"__N_SSG":true}